<!DOCTYPE html>
<html lang="de" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bewerbung AI - KI-generierte Bewerbungsschreiben | Anschreiben Generator</title>
    <meta name="description" content="Erstellen Sie maßgeschneiderte Bewerbungsschreiben mit KI. Unser Service analysiert Ihre Biografie und Stellenausschreibungen, um personalisierte Anschreiben nach DIN 5008 zu generieren. Schnell, einfach und kostenlos.">
    <meta name="keywords" content="Bewerbung, Anschreiben, KI, AI, Bewerbungsschreiben, Lebenslauf, Stellenausschreibung, DIN 5008, Bewerbung Generator">
    <meta name="author" content="Bewerbung AI">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="http://130.162.224.203:8080/">
    
    <!-- Hreflang для мультиязычности -->
    <link rel="alternate" hreflang="de" href="http://130.162.224.203:8080/">
    <link rel="alternate" hreflang="ru" href="http://130.162.224.203:8080/">
    <link rel="alternate" hreflang="en" href="http://130.162.224.203:8080/">
    <link rel="alternate" hreflang="x-default" href="http://130.162.224.203:8080/">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicons/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/favicons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/favicons/favicon-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/favicons/favicon-512x512.png">
    <link rel="apple-touch-icon" sizes="57x57" href="/favicons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/favicons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/favicons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/favicons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/favicons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/favicons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/favicons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/favicons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon-180x180.png">
    <link rel="shortcut icon" href="/favicons/favicon.ico">
    <meta name="msapplication-TileImage" content="/favicons/favicon-192x192.png">
    <meta name="msapplication-TileColor" content="#2563eb">
    
    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Bewerbung AI",
      "alternateName": "Bewerbung Anschreiben Generator",
      "description": "KI-gestützter Service zur automatischen Generierung von Bewerbungsschreiben nach deutschen DIN 5008 Standards",
      "url": "http://130.162.224.203:8080/",
      "applicationCategory": "BusinessApplication",
      "operatingSystem": "Web",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "EUR"
      },
      "creator": {
        "@type": "Organization",
        "name": "Bewerbung AI"
      },
      "inLanguage": ["de", "ru", "en"],
      "featureList": [
        "Automatische Analyse von Stellenausschreibungen",
        "Personalisierte Bewerbungsschreiben",
        "DIN 5008 konform",
        "Mehrsprachig (DE, RU, EN)"
      ]
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Bewerbung AI",
      "url": "http://130.162.224.203:8080/",
      "logo": "http://130.162.224.203:8080/bewerbug.png",
      "sameAs": []
    }
    </script>
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="http://130.162.224.203:8080/">
    <meta property="og:title" content="Bewerbung AI - KI-generierte Bewerbungsschreiben | Anschreiben Generator">
    <meta property="og:description" content="Erstellen Sie maßgeschneiderte Bewerbungsschreiben mit KI. Unser Service analysiert Ihre Biografie und Stellenausschreibungen, um personalisierte Anschreiben nach DIN 5008 zu generieren. Schnell, einfach und kostenlos.">
    <meta property="og:image" content="http://130.162.224.203:8080/bewerbug.png">
    <meta property="og:image:secure_url" content="http://130.162.224.203:8080/bewerbug.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:type" content="image/png">
    <meta property="og:image:alt" content="Bewerbung AI - KI-generierte Bewerbungsschreiben Generator">
    <meta property="og:site_name" content="Bewerbung AI">
    <meta property="og:locale" content="de_DE">
    <meta property="og:locale:alternate" content="ru_RU">
    <meta property="og:locale:alternate" content="en_US">
    <meta property="article:author" content="Bewerbung AI">
    <meta property="og:updated_time" content="2025-01-27T00:00:00+00:00">
    
    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Bewerbung AI - KI-generierte Bewerbungsschreiben">
    <meta name="twitter:description" content="Erstellen Sie maßgeschneiderte Bewerbungsschreiben mit KI. Personalisierte Anschreiben nach DIN 5008 Standards. Schnell, einfach und kostenlos.">
    <meta name="twitter:image" content="http://130.162.224.203:8080/bewerbug.png">
    <meta name="twitter:image:alt" content="Bewerbung AI - KI-generierte Bewerbungsschreiben Generator">
    <meta name="twitter:site" content="@bewerbungai">
    <meta name="twitter:creator" content="@bewerbungai">
    <!-- Tailwind CSS via CDN for the full UI styling -->
    <script>
        // Tailwind config: enable class-based dark mode for theme toggle
        window.tailwind = window.tailwind || {};
        window.tailwind.config = Object.assign(window.tailwind.config || {}, { darkMode: 'class' });
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Single font family (Inter with system fallback) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Minimal custom styles for the SVG progress ring (not covered by Tailwind) */
        .progress-ring {
            width: 200px;
            height: 200px;
            position: relative;
        }

        .progress-ring svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .progress-segment {
            fill: none;
            stroke-width: 6;
            stroke-linecap: round;
            transition: stroke 0.4s ease;
        }

        .progress-segment.active {
            stroke: url(#gradient);
        }

        .progress-segment.active.blinking {
            animation: blink-segment 1.2s ease-in-out infinite;
        }

        @keyframes blink-segment {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.4;
            }
        }

        .progress-segment.inactive {
            stroke: #e5e7eb;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 32px;
            font-weight: 600;
            color: #0f172a;
            text-align: center;
        }

        .progress-label {
            margin-top: 24px;
            font-size: 14px;
            color: #64748b;
            text-align: center;
            min-height: 24px;
            font-weight: 500;
        }

        .progress-label.active {
            color: #1d4ed8;
        }

        /* Dark theme adjustments for the SVG progress UI */
        .dark .progress-segment.inactive {
            stroke: #334155;
        }

        .dark .progress-text {
            color: #e2e8f0;
        }

        .dark .progress-label {
            color: #94a3b8;
        }

        .dark .progress-label.active {
            color: #60a5fa;
        }

        /* Dark theme fallback overrides (in case dark: classes are not generated by CDN) */
        html.dark body,
        body.dark {
            background-color: #0f172a;
            color: #e2e8f0;
        }

        html.dark .container,
        body.dark .container {
            background-color: #020617;
            box-shadow: 0 0 0 1px #1e293b;
        }

        html.dark label,
        body.dark label {
            color: #e2e8f0;
        }

        html.dark textarea,
        body.dark textarea {
            background-color: #0f172a;
            color: #e2e8f0;
            border-color: #334155;
        }

        html.dark #themeToggle,
        body.dark #themeToggle {
            background-color: #0f172a;
            border-color: #334155;
            color: #e2e8f0;
        }

        html.dark #generateButton,
        body.dark #generateButton {
            background-color: #2563eb;
        }

        html.dark #generateButton:hover,
        body.dark #generateButton:hover {
            background-color: #1d4ed8;
        }

        html.dark .download-button,
        body.dark .download-button {
            background-color: #0f172a;
            border-color: #3b82f6;
            color: #bfdbfe;
        }

        html.dark .download-button:hover,
        body.dark .download-button:hover {
            background-color: #1e293b;
        }

        html.dark #loading,
        body.dark #loading {
            background-color: #020617;
            border-color: #1e293b;
            color: #cbd5f5;
        }

        html.dark .result-section,
        body.dark .result-section {
            background-color: rgba(15, 23, 42, 0.7);
            border-color: #334155;
        }

        html.dark .error,
        body.dark .error {
            background-color: rgba(127, 29, 29, 0.25);
            border-color: #7f1d1d;
            color: #fecaca;
        }

        html.dark .error .result-content,
        body.dark .error .result-content {
            background-color: #0f172a;
            border-color: #7f1d1d;
            color: #fecaca;
        }

        html.dark footer,
        body.dark footer {
            border-color: #1e293b;
            color: #94a3b8;
        }

        html.dark footer h3,
        body.dark footer h3 {
            color: #e2e8f0;
        }

        html.dark .app-title,
        body.dark .app-title {
            color: #f8fafc;
        }

        /* Language selector styling */
        #languageSelector {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23666' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.5rem center;
            padding-right: 2rem;
        }

        /* Scroll to top button */
        #scrollToTop {
            position: fixed !important;
            bottom: 2rem !important;
            right: 2rem !important;
            width: 3rem !important;
            height: 3rem !important;
            background-color: #ffffff !important;
            border: 1px solid #e2e8f0 !important;
            border-radius: 0.75rem !important;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05) !important;
            display: none;
            align-items: center !important;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 9999 !important;
        }

        #scrollToTop:hover {
            background-color: #f8fafc;
            border-color: #cbd5e1;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transform: translateY(-2px);
        }

        #scrollToTop:active {
            transform: translateY(0);
        }

        html.dark #scrollToTop,
        body.dark #scrollToTop {
            background-color: #0f172a;
            border-color: #334155;
        }

        html.dark #scrollToTop:hover,
        body.dark #scrollToTop:hover {
            background-color: #1e293b;
            border-color: #475569;
        }

        #scrollToTop svg {
            width: 1.25rem;
            height: 1.25rem;
            color: #475569;
            transition: color 0.3s ease;
        }

        html.dark #scrollToTop svg,
        body.dark #scrollToTop svg {
            color: #94a3b8;
        }

        #scrollToTop:hover svg {
            color: #2563eb;
        }

        html.dark #scrollToTop:hover svg,
        body.dark #scrollToTop:hover svg {
            color: #60a5fa;
        }

        /* Toast notification */
        #toastNotification {
            position: fixed;
            bottom: 5rem;
            right: 2rem;
            background-color: #ffffff;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1rem 1.25rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            display: none;
            align-items: center;
            gap: 0.75rem;
            z-index: 10000;
            max-width: 20rem;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        #toastNotification.show {
            display: flex;
        }

        html.dark #toastNotification,
        body.dark #toastNotification {
            background-color: #1e293b;
            border-color: #334155;
            color: #e2e8f0;
        }

        #toastNotification svg {
            width: 1.25rem;
            height: 1.25rem;
            flex-shrink: 0;
            color: #2563eb;
        }

        html.dark #toastNotification svg,
        body.dark #toastNotification svg {
            color: #60a5fa;
        }

        #toastNotification p {
            margin: 0;
            font-size: 0.875rem;
            line-height: 1.25rem;
            color: #475569;
        }

        html.dark #toastNotification p,
        body.dark #toastNotification p {
            color: #cbd5e1;
        }

        /* SEO Details blocks styling */
        details summary::-webkit-details-marker {
            display: none;
        }

        details summary {
            list-style: none;
        }

        details[open] summary svg {
            transform: rotate(180deg);
        }
    </style>
    <meta name="google-site-verification" content="PftA0fFd4ZVXys4GbFRN09Wb1_cnJrhGb35qOgGs0-Y" />
</head>
<body class="min-h-screen bg-slate-50 text-slate-800 antialiased dark:bg-slate-900 dark:text-slate-100 dark" style="font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;">
    <!-- Page container (single column layout: form -> result) -->
    <div class="container mx-auto max-w-5xl rounded-2xl bg-white px-6 py-8 shadow-sm ring-1 ring-slate-200 dark:bg-slate-950 dark:ring-slate-800 sm:px-10 sm:py-10">
        <!-- Header: title and theme toggle -->
        <header>
            <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
                <h1 class="app-title text-center text-2xl font-semibold tracking-tight text-slate-900 dark:text-white sm:text-left sm:text-3xl" data-i18n="appTitle">Bewerbunganschreiben AI</h1>
                <div class="flex items-center gap-2">
                    <!-- Language selector -->
                    <div class="relative inline-block">
                        <select id="languageSelector" class="inline-flex items-center justify-center rounded-xl border border-slate-200 bg-white px-3 py-2 text-xs font-semibold text-slate-700 shadow-sm transition-colors hover:bg-slate-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-200 dark:hover:bg-slate-800 appearance-none pr-8 cursor-pointer">
                            <option value="de">DE</option>
                            <option value="ru">RU</option>
                            <option value="en">EN</option>
                        </select>
                    </div>
                    <!-- Theme toggle (pure frontend; no backend interaction) -->
                    <button type="button" id="themeToggle" class="inline-flex items-center justify-center rounded-xl border border-slate-200 bg-white px-4 py-2 text-xs font-semibold text-slate-700 shadow-sm transition-colors hover:bg-slate-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-200 dark:hover:bg-slate-800" data-i18n="themeToggle">Dunkelmodus</button>
                </div>
            </div>
        </header>

        <main>
        <div class="mt-6 rounded-2xl border border-slate-200 bg-slate-50/60 px-6 py-5 shadow-sm dark:border-slate-700 dark:bg-slate-900/60">
            <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
                <p class="text-sm text-slate-600 dark:text-slate-300" data-i18n="reviewPrompt">Ich wäre Ihnen dankbar, wenn Sie mir ein paar Zeilen mit Ihren Eindrücken zu diesem Service hinterlassen</p>
                <a href="/reviews.html" class="inline-flex items-center justify-center rounded-xl border border-blue-600 bg-white px-5 py-2 text-sm font-semibold text-blue-700 shadow-sm transition-colors hover:bg-blue-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 dark:border-blue-500 dark:bg-slate-900 dark:text-blue-200 dark:hover:bg-slate-800" data-i18n="submitReview">Bewertung abgeben</a>
            </div>
        </div>

        <!-- Help block -->
        <div class="mt-6 rounded-2xl border border-blue-200 bg-blue-50/60 px-6 py-5 shadow-sm dark:border-blue-800/60 dark:bg-blue-950/40">
            <div class="flex items-start gap-3">
                <div class="flex-shrink-0 mt-0.5">
                    <svg class="w-5 h-5 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                </div>
                <div class="flex-1">
                    <h3 class="text-sm font-semibold text-blue-900 dark:text-blue-100 mb-2" data-i18n="helpTitle">Помощь</h3>
                    <div class="text-sm text-blue-800 dark:text-blue-200 leading-relaxed space-y-2">
                        <p data-i18n="helpDescription">Dieser Service erstellt ein maßgeschneidertes Bewerbungsanschreiben, das auf Ihr Lebenslauf und die Anforderungen der Stellenausschreibung abgestimmt ist.</p>
                        <p data-i18n="helpLanguageText">Sie können Ihre Daten in jeder beliebigen Sprache eingeben. Das generierte Anschreiben wird automatisch in der Sprache erstellt, die Sie im Sprachauswahlmenü oben ausgewählt haben (DE, RU oder EN).</p>
                        <p data-i18n="helpPrivacyText">Wir speichern keine personenbezogenen Daten dauerhaft. Eingegebene Inhalte werden ausschließlich zur unmittelbaren Verarbeitung verwendet und nach Beendigung der Sitzung automatisch gelöscht. Die technische Bereitstellung erfolgt über <a href="https://www.oracle.com/cloud/" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline">Oracle Cloud</a>, die Verarbeitung bestimmter Inhalte über die OpenAI-API – jeweils gemäß den Anforderungen der DSGVO.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Input form (IDs must stay stable for JS bindings) -->
        <form id="generateForm" class="mt-8 space-y-6">
            <div class="form-group space-y-2">
                <label for="biographyTextarea" class="block text-sm font-medium text-slate-700 dark:text-slate-200" data-i18n="biographyLabel">Biography - Verfassen Sie Ihren Lebenslauf in einem freien Format: Persönliches
                    Daten, Ihre Fähigkeiten, Berufserfahrung, Ausbildung:</label>
                <textarea id="biographyTextarea" name="biography" required class="min-h-[300px] w-full resize-y rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-800 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:focus:border-blue-400 dark:focus:ring-blue-900"></textarea>
            </div>

            <div class="form-group space-y-2">
                <button type="button" id="uploadPhotoButton" class="inline-flex items-center justify-center rounded-xl bg-blue-600 px-5 py-2 text-sm font-semibold text-white shadow-sm transition-colors hover:bg-blue-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:bg-slate-300 dark:bg-blue-500 dark:hover:bg-blue-600 dark:disabled:bg-slate-700" data-i18n="uploadPhotoButton">Загрузить фото для резюме</button>
                <input id="photoInput" type="file" accept="image/*" class="hidden" />
                <p id="photoUploadStatus" class="text-sm text-slate-600 dark:text-slate-300"></p>
            </div>
            
            <div class="form-group space-y-2">
                <label for="jobPostingTextarea" class="block text-sm font-medium text-slate-700 dark:text-slate-200" data-i18n="jobPostingLabel">Job Posting - kopieren Sie einfach den Text der Stellenanzeige hierher.:</label>
                <textarea id="jobPostingTextarea" name="jobPosting" required class="min-h-[200px] w-full resize-y rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-800 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:focus:border-blue-400 dark:focus:ring-blue-900"></textarea>
            </div>
            
            <div class="form-group space-y-2">
                <label for="wishesTextarea" class="block text-sm font-medium text-slate-700 dark:text-slate-200" data-i18n="wishesLabel">Hier können Sie einen zusätzlichen Prompt (Anweisung für die KI) oder Informationen über Sie hinzufügen, die nicht in den Lebenslauf aufgenommen wurden (optional):</label>
                <textarea id="wishesTextarea" name="wishes" class="min-h-[150px] w-full resize-y rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-800 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:focus:border-blue-400 dark:focus:ring-blue-900"></textarea>
            </div>
            
            <button type="submit" id="generateButton" class="w-full rounded-xl bg-blue-600 px-6 py-3 text-sm font-semibold text-white shadow-sm transition-colors hover:bg-blue-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:bg-slate-300 dark:bg-blue-500 dark:hover:bg-blue-600 dark:disabled:bg-slate-700" data-i18n="generateButton">Dokumente erstellen</button>
        </form>

        <!-- Loading state (visibility controlled by JS via .hidden class) -->
        <div id="loading" class="loading hidden mt-8 rounded-2xl border border-slate-200 bg-white px-6 py-10 text-center text-sm text-slate-600 shadow-sm dark:border-slate-700 dark:bg-slate-950 dark:text-slate-300">
            <div class="progress-container flex flex-col items-center justify-center">
                <div class="progress-ring">
                    <svg viewBox="0 0 100 100">
                        <defs>
                            <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#5dade2;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#2563eb;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <!-- Segments will be generated by JavaScript -->
                    </svg>
                    <div class="progress-text" id="progressPercent">0%</div>
                </div>
                <div class="progress-label" id="progressLabel" data-i18n="progressInitializing">Initialisiere...</div>
            </div>
        </div>

        <!-- Error output (filled by JS) -->
        <div id="errorSection" class="results hidden mt-8">
            <div class="result-section error rounded-2xl border border-red-200 bg-red-50 px-6 py-5 text-red-700 shadow-sm dark:border-red-900/60 dark:bg-red-950/40 dark:text-red-200">
                <h2 class="text-base font-semibold text-red-700 dark:text-red-200" data-i18n="errorTitle">Error</h2>
                <div class="result-content mt-3 whitespace-pre-wrap rounded-xl border border-red-200 bg-white px-4 py-3 text-sm text-red-700 dark:border-red-900/60 dark:bg-slate-900 dark:text-red-200" id="errorContent"></div>
            </div>
        </div>

        <!-- Results output (filled by JS) -->
        <div id="results" class="results hidden mt-8">
            <div class="result-section rounded-2xl border border-slate-200 bg-slate-50/60 px-6 py-5 shadow-sm dark:border-slate-700 dark:bg-slate-900/60">
                <h2 class="text-base font-semibold text-slate-900 dark:text-slate-100" data-i18n="coverLetterTitle">Cover Letter (Anschreiben)</h2>
                <textarea id="coverLetterTextarea" class="result-content editable mt-3 min-h-[400px] w-full resize-y rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-800 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:focus:border-blue-400 dark:focus:ring-blue-900"></textarea>
                <div class="mt-4 grid gap-3 sm:grid-cols-2">
                    <button type="button" id="downloadLebenslaufButton" class="download-button w-full rounded-xl border border-blue-600 bg-white px-6 py-3 text-sm font-semibold text-blue-700 shadow-sm transition-colors hover:bg-blue-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-60 dark:border-blue-500 dark:bg-slate-900 dark:text-blue-200 dark:hover:bg-slate-800" data-i18n="downloadLebenslaufButton">Herunterladen Lebenslauf</button>
                    <button type="button" id="downloadAnschreibenButton" class="download-button w-full rounded-xl border border-blue-600 bg-white px-6 py-3 text-sm font-semibold text-blue-700 shadow-sm transition-colors hover:bg-blue-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-60 dark:border-blue-500 dark:bg-slate-900 dark:text-blue-200 dark:hover:bg-slate-800" data-i18n="downloadAnschreibenButton">Herunterladen Bewerbungsanschreiben</button>
                </div>
            </div>
        </div>

        <!-- Share section -->
        <div class="mt-10 border-t border-slate-200 pt-6 text-center dark:border-slate-800">
            <p class="text-sm text-slate-600 dark:text-slate-300 mb-4" data-i18n="sharePrompt">Если вам понравилось поделитесь этим сервисом с коллегами!</p>
            <div class="flex justify-center gap-4">
                <a id="whatsappShareMain" href="#" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-slate-600 text-white hover:bg-slate-700 transition-colors shadow-sm dark:bg-slate-500 dark:hover:bg-slate-600" data-i18n-title="whatsappShareTitle" title="Поделиться в WhatsApp">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
                    </svg>
                </a>
                <a id="facebookShareMain" href="#" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-slate-600 text-white hover:bg-slate-700 transition-colors shadow-sm dark:bg-slate-500 dark:hover:bg-slate-600" data-i18n-title="facebookShareTitle" title="Поделиться в Facebook">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                    </svg>
                </a>
                <a id="linkedinShareMain" href="#" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-slate-600 text-white hover:bg-slate-700 transition-colors shadow-sm dark:bg-slate-500 dark:hover:bg-slate-600" data-i18n-title="linkedinShareTitle" title="Поделиться в LinkedIn">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                    </svg>
                </a>
                <a id="telegramShareMain" href="#" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-slate-600 text-white hover:bg-slate-700 transition-colors shadow-sm dark:bg-slate-500 dark:hover:bg-slate-600" data-i18n-title="telegramShareTitle" title="Поделиться в Telegram">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                    </svg>
                </a>
                <a id="instagramShareMain" href="#" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-slate-600 text-white hover:bg-slate-700 transition-colors shadow-sm dark:bg-slate-500 dark:hover:bg-slate-600" data-i18n-title="instagramShareTitle" title="Поделиться в Instagram">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                    </svg>
                </a>
            </div>
        </div>

        <!-- SEO Content Blocks (Collapsible) -->
        <div class="mt-10 space-y-4">
            <!-- SEO Block 1: Поиск работы в Германии -->
            <details class="group rounded-xl border border-slate-200 bg-slate-50/60 px-6 py-4 shadow-sm dark:border-slate-700 dark:bg-slate-900/60">
                <summary class="cursor-pointer list-none text-sm font-semibold text-slate-900 dark:text-slate-100 hover:text-blue-600 dark:hover:text-blue-400">
                    <span class="flex items-center justify-between">
                        <span>Поиск работы в Германии</span>
                        <svg class="w-5 h-5 transform transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </span>
                </summary>
                <div class="mt-4 text-sm text-slate-600 dark:text-slate-300 leading-relaxed space-y-2">
                    <p>Поиск работы в Германии (Jobsuche in Deutschland) начинается не с собеседования, а с безупречно оформленной папки документов. Немецкие HR-менеджеры и автоматизированные системы подбора (ATS) тратят в среднем всего 6 секунд на первичный просмотр вашей заявки. Если ваше Bewerbung на немецком не соответствует стандартам DIN 5008, шансы на приглашение резко снижаются.</p>
                    <p>Наш сервис разработан специально для того, чтобы помочь вам подготовить профессиональное резюме (Lebenslauf) и сопроводительное письмо (Anschreiben) онлайн. Мы учитываем специфику немецкого рынка труда, помогая вам выделиться среди сотен других кандидатов.</p>
                </div>
            </details>

            <!-- SEO Block 2: Bewerbung и резюме на немецком языке -->
            <details class="group rounded-xl border border-slate-200 bg-slate-50/60 px-6 py-4 shadow-sm dark:border-slate-700 dark:bg-slate-900/60">
                <summary class="cursor-pointer list-none text-sm font-semibold text-slate-900 dark:text-slate-100 hover:text-blue-600 dark:hover:text-blue-400">
                    <span class="flex items-center justify-between">
                        <span>Bewerbung и резюме на немецком языке</span>
                        <svg class="w-5 h-5 transform transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </span>
                </summary>
                <div class="mt-4 text-sm text-slate-600 dark:text-slate-300 leading-relaxed space-y-2">
                    <p>Успешный поиск работы в Германии требует понимания местной бизнес-культуры. В отличие от многих других стран, здесь до сих пор ценится формализм и структурированность.</p>
                    <ul class="list-disc list-inside space-y-1 ml-4">
                        <li>Четкая структура: Ваши документы должны быть логичными и легко читаемыми.</li>
                        <li>Акцент на квалификацию: В Германии важно подтверждать каждый навык опытом или сертификатом.</li>
                        <li>Индивидуальный подход: «Массовая рассылка» одинаковых писем не работает. Каждое Bewerbung должно быть адаптировано под конкретную вакансию.</li>
                    </ul>
                </div>
            </details>

            <!-- SEO Block 3: Создать резюме для работы в Германии онлайн -->
            <details class="group rounded-xl border border-slate-200 bg-slate-50/60 px-6 py-4 shadow-sm dark:border-slate-700 dark:bg-slate-900/60">
                <summary class="cursor-pointer list-none text-sm font-semibold text-slate-900 dark:text-slate-100 hover:text-blue-600 dark:hover:text-blue-400">
                    <span class="flex items-center justify-between">
                        <span>Создать резюме для работы в Германии онлайн</span>
                        <svg class="w-5 h-5 transform transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </span>
                </summary>
                <div class="mt-4 text-sm text-slate-600 dark:text-slate-300 leading-relaxed space-y-2">
                    <p>Bewerbung на немецком языке — это комплексный пакет документов. Главная ошибка русскоязычных соискателей — прямой перевод своего резюме с русского языка.</p>
                    <ol class="list-decimal list-inside space-y-2 ml-4">
                        <li><strong>Lebenslauf (Резюме):</strong> В Германии принято использовать хронологический порядок (от последнего места работы к первому). Фотография, дата рождения и семейное положение здесь все еще приветствуются, в отличие от США или Великобритании.</li>
                        <li><strong>Anschreiben (Сопроводительное письмо):</strong> Это ваша единственная возможность объяснить, почему именно вы подходите компании. Оно должно занимать строго одну страницу А4.</li>
                    </ol>
                </div>
            </details>

            <!-- SEO Block 4: Онлайн-генератор Bewerbung -->
            <details class="group rounded-xl border border-slate-200 bg-slate-50/60 px-6 py-4 shadow-sm dark:border-slate-700 dark:bg-slate-900/60">
                <summary class="cursor-pointer list-none text-sm font-semibold text-slate-900 dark:text-slate-100 hover:text-blue-600 dark:hover:text-blue-400">
                    <span class="flex items-center justify-between">
                        <span>Онлайн-генератор Bewerbung: создайте документы за 10 минут</span>
                        <svg class="w-5 h-5 transform transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </span>
                </summary>
                <div class="mt-4 text-sm text-slate-600 dark:text-slate-300 leading-relaxed space-y-2">
                    <p>Забудьте о сложных шаблонах в Word, которые «едут» при сохранении. Наш онлайн-генератор мотивационного письма для работы в Германии позволяет:</p>
                    <ul class="list-disc list-inside space-y-1 ml-4">
                        <li>Выбрать проверенный немецкий формат.</li>
                        <li>Использовать правильные профессиональные термины на немецком.</li>
                        <li>Скачать готовый результат в PDF, готовый к отправке работодателю.</li>
                    </ul>
                    <p>Это идеальное решение для тех, кто хочет сэкономить время и быть уверенным в корректности оформления своего Bewerbung онлайн.</p>
                </div>
            </details>

            <!-- SEO Block 5: Для иностранных соискателей в Германии -->
            <details class="group rounded-xl border border-slate-200 bg-slate-50/60 px-6 py-4 shadow-sm dark:border-slate-700 dark:bg-slate-900/60">
                <summary class="cursor-pointer list-none text-sm font-semibold text-slate-900 dark:text-slate-100 hover:text-blue-600 dark:hover:text-blue-400">
                    <span class="flex items-center justify-between">
                        <span>Для иностранных соискателей в Германии</span>
                        <svg class="w-5 h-5 transform transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </span>
                </summary>
                <div class="mt-4 text-sm text-slate-600 dark:text-slate-300 leading-relaxed">
                    <p>Мы понимаем боли соискателей из зарубежа. Переезд по Blue Card, поиск работы с параграфом 24 или поиск первой работы после обучения в Германии (Ausbildung) — каждый кейс требует своего подхода. Наш сервис помогает адаптировать ваш прошлый опыт под ожидания немецких работодателей, сглаживая культурный и языковой барьер.</p>
                </div>
            </details>
        </div>

        </main>

        <!-- Legal footer / privacy note -->
        <footer class="mt-10 border-t border-slate-200 pt-6 text-center text-xs text-slate-500 dark:border-slate-800 dark:text-slate-400">
            <h3 class="text-sm font-semibold text-slate-700 dark:text-slate-200" data-i18n="privacyTitle">Datenschutz</h3>
            <p class="mt-2 leading-relaxed" data-i18n="privacyText">Die technische Bereitstellung erfolgt über <a href="https://www.oracle.com/cloud/" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline">Oracle Cloud</a>, die Verarbeitung bestimmter Inhalte über die OpenAI-API – jeweils gemäß den Anforderungen der DSGVO.</p>
            <div class="mt-4 flex flex-col sm:flex-row justify-center items-center gap-4">
                <a href="/datenschutz.html" class="text-blue-600 dark:text-blue-400 hover:underline" data-i18n="privacyLinkFooter">Datenschutzerklärung</a>
                <span class="hidden sm:inline">|</span>
                <a href="/impressum.html" class="text-blue-600 dark:text-blue-400 hover:underline" data-i18n="impressumLink">Impressum</a>
                <span class="hidden sm:inline">|</span>
                <a href="/faq.html" class="text-blue-600 dark:text-blue-400 hover:underline" data-i18n="faqLink">Häufig gestellte Fragen (FAQ)</a>
            </div>
        </footer>
    </div>

    <script>
        // Save source tracking on page load
        (function saveSourceOnLoad() {
            function detectSourceFromUrl() {
                const urlParams = new URLSearchParams(window.location.search);
                
                // Facebook
                if (urlParams.has('fbclid')) {
                    return 'Facebook';
                }
                
                // LinkedIn
                if (urlParams.has('li_fat_id') || urlParams.get('utm_source') === 'linkedin') {
                    return 'LinkedIn';
                }
                
                // Twitter/X
                if (urlParams.get('utm_source') === 'twitter' || urlParams.get('utm_source') === 'x') {
                    return 'Twitter';
                }
                
                // Instagram
                if (urlParams.get('utm_source') === 'instagram') {
                    return 'Instagram';
                }
                
                // WhatsApp
                if (urlParams.get('utm_source') === 'whatsapp') {
                    return 'WhatsApp';
                }
                
                // Telegram
                if (urlParams.get('utm_source') === 'telegram') {
                    return 'Telegram';
                }
                
                // Generic utm_source
                const utmSource = urlParams.get('utm_source');
                if (utmSource) {
                    // Capitalize first letter
                    return utmSource.charAt(0).toUpperCase() + utmSource.slice(1);
                }
                
                return null;
            }
            
            const sourceFromUrl = detectSourceFromUrl();
            if (sourceFromUrl) {
                try {
                    sessionStorage.setItem('bewerbung-ai-source', sourceFromUrl);
                } catch (e) {
                    // Ignore storage errors
                }
            }
        })();

        // Theme toggle (frontend only, no backend dependency)
        (function initThemeToggle() {
            const themeToggle = document.getElementById('themeToggle');
            const rootElement = document.documentElement;
            const THEME_STORAGE_KEY = 'bewerbung-ai-theme';
            const THEME_VERSION_KEY = 'bewerbung-ai-theme-version';
            const THEME_VERSION = '2';

            function safeGetStoredValue(key) {
                try {
                    return localStorage.getItem(key);
                } catch (error) {
                    return null;
                }
            }

            function safeStoreValue(key, value) {
                try {
                    localStorage.setItem(key, value);
                } catch (error) {
                    // Storage can be blocked on some mobile browsers; ignore silently.
                }
            }

            function applyTheme(theme) {
                const isDark = theme === 'dark';
                rootElement.classList.toggle('dark', isDark);
                if (document.body) {
                    document.body.classList.toggle('dark', isDark);
                }
                if (themeToggle && window.i18n) {
                    themeToggle.textContent = isDark 
                        ? window.i18n.translate('themeToggleLight') 
                        : window.i18n.translate('themeToggle');
                } else if (themeToggle) {
                    themeToggle.textContent = isDark ? 'Hellmodus' : 'Dunkelmodus';
                }
            }

            const storedTheme = safeGetStoredValue(THEME_STORAGE_KEY);
            const storedVersion = safeGetStoredValue(THEME_VERSION_KEY);
            if (storedVersion !== THEME_VERSION) {
                // Force default dark when theme settings schema changes
                applyTheme('dark');
                safeStoreValue(THEME_STORAGE_KEY, 'dark');
                safeStoreValue(THEME_VERSION_KEY, THEME_VERSION);
            } else if (storedTheme === 'dark' || storedTheme === 'light') {
                applyTheme(storedTheme);
            } else {
                // Default theme is dark as requested
                applyTheme('dark');
            }

            if (themeToggle) {
                themeToggle.addEventListener('click', () => {
                    const nextTheme = rootElement.classList.contains('dark') ? 'light' : 'dark';
                    applyTheme(nextTheme);
                    safeStoreValue(THEME_STORAGE_KEY, nextTheme);
                    safeStoreValue(THEME_VERSION_KEY, THEME_VERSION);
                });
            }
        })();

        // Language/i18n Management
        (function initLanguageSystem() {
            const LANGUAGE_STORAGE_KEY = 'bewerbung-ai-language';
            const translations = {
                de: {
                    appTitle: 'Bewerbunganschreiben AI',
                    themeToggle: 'Dunkelmodus',
                    themeToggleLight: 'Hellmodus',
                    serviceDescription: 'Dieser Service erstellt ein maßgeschneidertes Bewerbungsanschreiben, das auf Ihr Lebenslauf und die Anforderungen der Stellenausschreibung abgestimmt ist.',
                    reviewPrompt: 'Ich wäre Ihnen dankbar, wenn Sie mir ein paar Zeilen mit Ihren Eindrücken zu diesem Service hinterlassen',
                    submitReview: 'Bewertung abgeben',
                    biographyLabel: 'Biography - Verfassen Sie Ihren Lebenslauf in einem freien Format: Ihre Fähigkeiten, Berufserfahrung, Ausbildung:',
                    uploadPhotoButton: 'Foto fuer Lebenslauf hochladen',
                    photoUploadProgress: 'Foto wird hochgeladen...',
                    photoUploadSuccess: 'Foto erfolgreich hochgeladen',
                    photoUploadError: 'Foto konnte nicht hochgeladen werden',
                    photoUploadInvalidType: 'Nur Bilddateien sind erlaubt',
                    photoUploadTooLarge: 'Foto ist zu gross (max. 5 MB)',
                    jobPostingLabel: 'Job Posting - kopieren Sie einfach den Text der Stellenanzeige hierher.:',
                    wishesLabel: 'Hier können Sie einen zusätzlichen Prompt (Anweisung für die KI) oder Informationen über Sie hinzufügen, die nicht in den Lebenslauf aufgenommen wurden (optional):',
                    generateButton: 'Dokumente erstellen',
                    progressInitializing: 'Initialisiere...',
                    progressReadingBiography: 'Lese Lebenslauf',
                    progressAnalyzingBiography: 'Analysiere Lebenslauf',
                    progressReadingJobPosting: 'Lese Stellenausschreibung',
                    progressAnalyzingJobPosting: 'Analysiere Stellenausschreibung',
                    progressCreatingLetter: 'Erstelle Anschreiben',
                    progressGenerating: 'Generiere Inhalt...',
                    progressFinalizing: 'Finalisiere Dokument',
                    progressComplete: 'Abgeschlossen',
                    errorTitle: 'Error',
                    coverLetterTitle: 'Cover Letter (Anschreiben)',
                    downloadLebenslaufButton: 'Herunterladen Lebenslauf',
                    downloadAnschreibenButton: 'Herunterladen Bewerbungsanschreiben',
                    downloadLebenslaufButtonGenerating: 'Lebenslauf-PDF wird generiert...',
                    downloadAnschreibenButtonGenerating: 'Anschreiben-PDF wird generiert...',
                    privacyTitle: 'Datenschutz',
                    privacyText: 'Die technische Bereitstellung erfolgt über <a href="https://www.oracle.com/cloud/" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline">Oracle Cloud</a>, die Verarbeitung bestimmter Inhalte über die OpenAI-API – jeweils gemäß den Anforderungen der DSGVO.',
                    errorBiographyEmpty: 'Biography cannot be empty',
                    errorJobPostingEmpty: 'Job posting cannot be empty',
                    errorInvalidResponse: 'Invalid response from server',
                    errorApiError: 'An error occurred',
                    errorPdfGeneration: 'PDF-Generierung fehlgeschlagen',
                    errorPdfError: 'Fehler beim Generieren des PDFs: ',
                    alertFillLetter: 'Bitte füllen Sie zuerst das Anschreiben aus.',
                    helpTitle: 'Hilfe',
                    helpDescription: 'Dieser Service erstellt ein maßgeschneidertes Bewerbungsanschreiben, das auf Ihr Lebenslauf und die Anforderungen der Stellenausschreibung abgestimmt ist.',
                    helpLanguageText: 'Sie können Ihre Daten in jeder beliebigen Sprache eingeben. Das generierte Anschreiben wird automatisch in der Sprache erstellt, die Sie im Sprachauswahlmenü oben ausgewählt haben (DE, RU oder EN).',
                    helpPrivacyText: 'Wir speichern keine personenbezogenen Daten dauerhaft. Eingegebene Inhalte werden ausschließlich zur unmittelbaren Verarbeitung verwendet und nach Beendigung der Sitzung automatisch gelöscht. Die technische Bereitstellung erfolgt über <a href="https://www.oracle.com/cloud/" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline">Oracle Cloud</a>, die Verarbeitung bestimmter Inhalte über die OpenAI-API – jeweils gemäß den Anforderungen der DSGVO.',
                    sharePrompt: 'Wenn es Ihnen gefallen hat, teilen Sie diesen Service mit Kollegen!',
                    privacyLinkFooter: 'Datenschutzerklärung',
                    whatsappShareTitle: 'In WhatsApp teilen',
                    facebookShareTitle: 'In Facebook teilen',
                    linkedinShareTitle: 'In LinkedIn teilen',
                    telegramShareTitle: 'In Telegram teilen',
                    instagramShareTitle: 'In Instagram teilen',
                    instagramToastMessage: 'Link wurde kopiert, füge ihn in einen neuen Post ein.',
                    shareTextFull: 'Wenn Sie aktiv nach Arbeit suchen und sich auf viele Stellenangebote bewerben, wissen Sie, wie mühsam es ist, jedes Mal ein separates Motivationsschreiben zu verfassen.\n\nUm diesen Prozess zu vereinfachen, möchte ich einen Service empfehlen, der die Erstellung von Motivationsschreiben für verschiedene Stellenangebote erheblich beschleunigt. Dies spart Zeit und reduziert Routineaufgaben, insbesondere bei Massenbewerbungen.\n\nService:\n{url}\n\nWird nützlich sein für diejenigen, die aktiv nach Arbeit suchen und sich auf den Inhalt konzentrieren möchten, anstatt denselben Text endlos umzuschreiben.',
                    shareTextShort: 'Wenn Sie aktiv nach Arbeit suchen und sich auf viele Stellenangebote bewerben, wissen Sie, wie mühsam es ist, jedes Mal ein separates Motivationsschreiben zu verfassen. Um diesen Prozess zu vereinfachen, möchte ich einen Service empfehlen, der die Erstellung von Motivationsschreiben für verschiedene Stellenangebote erheblich beschleunigt.',
                    impressumLink: 'Impressum',
                    faqLink: 'Häufig gestellte Fragen (FAQ)',
                    faqQ1: 'Wie funktioniert der Bewerbung AI Service?',
                    faqA1: 'Unser Service verwendet künstliche Intelligenz (KI), um Ihre Biografie und die Stellenausschreibung zu analysieren. Basierend auf dieser Analyse generiert er ein maßgeschneidertes Bewerbungsschreiben, das auf die spezifischen Anforderungen der Position zugeschnitten ist und den deutschen DIN 5008 Standards entspricht.',
                    faqQ2: 'In welchen Sprachen kann ich den Service nutzen?',
                    faqA2: 'Sie können Ihre Daten in jeder beliebigen Sprache eingeben. Das generierte Bewerbungsschreiben wird automatisch in der Sprache erstellt, die Sie im Sprachauswahlmenü ausgewählt haben - Deutsch (DE), Russisch (RU) oder Englisch (EN).',
                    faqQ3: 'Werden meine Daten gespeichert?',
                    faqA3: 'Nein, wir speichern keine personenbezogenen Daten dauerhaft. Alle eingegebenen Inhalte werden ausschließlich zur unmittelbaren Verarbeitung verwendet und nach Beendigung der Sitzung automatisch gelöscht. Der Service ist vollständig DSGVO-konform.',
                    faqQ4: 'Ist der Service kostenlos?',
                    faqA4: 'Ja, der Service ist vollständig kostenlos. Sie können so viele Bewerbungsschreiben generieren, wie Sie benötigen, ohne Gebühren oder Registrierung.',
                    faqQ5: 'Kann ich das generierte Anschreiben bearbeiten?',
                    faqA5: 'Ja, nach der Generierung können Sie das Anschreiben direkt im Textfeld bearbeiten, bevor Sie es als PDF herunterladen. So können Sie persönliche Anpassungen vornehmen.'
                },
                ru: {
                    appTitle: 'Мотивационное письмо AI',
                    themeToggle: 'Темный режим',
                    themeToggleLight: 'Светлый режим',
                    serviceDescription: 'Этот сервис создает мотивационное письмо, релевантное вашему резюме и требованиям вакансии.',
                    reviewPrompt: 'Буду благодарен, если вы оставите несколько строк с вашими впечатлениями об этом сервисе',
                    submitReview: 'Оставить отзыв',
                    biographyLabel: 'Биография - Составьте свое резюме в свободном формате: ваши навыки, профессиональный опыт, образование:',
                    uploadPhotoButton: 'Загрузить фото для резюме',
                    photoUploadProgress: 'Загрузка фото...',
                    photoUploadSuccess: 'Фото успешно загружено',
                    photoUploadError: 'Не удалось загрузить фото',
                    photoUploadInvalidType: 'Разрешены только изображения',
                    photoUploadTooLarge: 'Фото слишком большое (макс. 5 МБ)',
                    jobPostingLabel: 'Вакансия - просто скопируйте текст объявления о вакансии сюда.:',
                    wishesLabel: 'Здесь вы можете добавить дополнительный промпт (указание для ИИ) или сведения о вас, которые не вошли в резюме (необязательно):',
                    generateButton: 'Создать документы',
                    progressInitializing: 'Инициализация...',
                    progressReadingBiography: 'Чтение резюме',
                    progressAnalyzingBiography: 'Анализ резюме',
                    progressReadingJobPosting: 'Чтение вакансии',
                    progressAnalyzingJobPosting: 'Анализ вакансии',
                    progressCreatingLetter: 'Создание письма',
                    progressGenerating: 'Генерация содержимого...',
                    progressFinalizing: 'Завершение документа',
                    progressComplete: 'Завершено',
                    errorTitle: 'Ошибка',
                    coverLetterTitle: 'Cover Letter (Anschreiben)',
                    downloadLebenslaufButton: 'Скачать резюме',
                    downloadAnschreibenButton: 'Скачать сопроводительное письмо',
                    downloadLebenslaufButtonGenerating: 'Генерация PDF резюме...',
                    downloadAnschreibenButtonGenerating: 'Генерация PDF письма...',
                    privacyTitle: 'Конфиденциальность',
                    privacyText: 'Техническое обеспечение осуществляется через <a href="https://www.oracle.com/cloud/" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline">Oracle Cloud</a>, обработка определенного контента через OpenAI API – каждый в соответствии с требованиями GDPR.',
                    errorBiographyEmpty: 'Biography cannot be empty',
                    errorJobPostingEmpty: 'Job posting cannot be empty',
                    errorInvalidResponse: 'Invalid response from server',
                    errorApiError: 'Произошла ошибка',
                    errorPdfGeneration: 'Ошибка генерации PDF',
                    errorPdfError: 'Ошибка при генерации PDF: ',
                    alertFillLetter: 'Пожалуйста, сначала заполните письмо.',
                    helpTitle: 'Помощь',
                    helpDescription: 'Этот сервис создает мотивационное письмо, релевантное вашему резюме и требованиям вакансии.',
                    helpLanguageText: 'Вы можете вводить данные на любом языке. Сгенерированное письмо будет автоматически создано на том языке, который вы выбрали в меню выбора языка вверху (DE, RU или EN).',
                    helpPrivacyText: 'Мы не храним персональные данные постоянно. Введенный контент используется исключительно для немедленной обработки и автоматически удаляется после завершения сессии. Техническое обеспечение осуществляется через <a href="https://www.oracle.com/cloud/" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline">Oracle Cloud</a>, обработка определенного контента через OpenAI API – каждый в соответствии с требованиями GDPR.',
                    sharePrompt: 'Если вам понравилось поделитесь этим сервисом с коллегами!',
                    privacyLinkFooter: 'Политика конфиденциальности',
                    impressumLink: 'Выходные данные',
                    whatsappShareTitle: 'Поделиться в WhatsApp',
                    facebookShareTitle: 'Поделиться в Facebook',
                    linkedinShareTitle: 'Поделиться в LinkedIn',
                    telegramShareTitle: 'Поделиться в Telegram',
                    instagramShareTitle: 'Поделиться в Instagram',
                    instagramToastMessage: 'Ссылка скопирована, вставь её в новый пост.',
                    shareTextFull: 'Если вы активно ищете работу и откликаетесь на большое количество вакансий, вы знаете, насколько утомительно каждый раз писать отдельное мотивационное письмо.\n\nЧтобы упростить этот процесс, я хочу порекомендовать сервис, который помогает значительно ускорить подготовку мотивационных писем под разные вакансии. Это экономит время и снижает рутину, особенно при массовых откликах.\n\nСервис:\n{url}\n\nБудет полезен тем, кто находится в активном поиске работы и хочет сосредоточиться на содержании, а не на бесконечном переписывании одного и того же текста.',
                    shareTextShort: 'Если вы активно ищете работу и откликаетесь на большое количество вакансий, вы знаете, насколько утомительно каждый раз писать отдельное мотивационное письмо. Чтобы упростить этот процесс, я хочу порекомендовать сервис, который помогает значительно ускорить подготовку мотивационных писем под разные вакансии.',
                    faqLink: 'Часто задаваемые вопросы (FAQ)',
                    faqQ1: 'Как работает сервис Bewerbung AI?',
                    faqA1: 'Наш сервис использует искусственный интеллект (ИИ) для анализа вашей биографии и вакансии. На основе этого анализа он генерирует персонализированное мотивационное письмо, адаптированное под конкретные требования позиции и соответствующее немецким стандартам DIN 5008.',
                    faqQ2: 'На каких языках я могу использовать сервис?',
                    faqA2: 'Вы можете вводить данные на любом языке. Сгенерированное мотивационное письмо будет автоматически создано на том языке, который вы выбрали в меню выбора языка - Немецкий (DE), Русский (RU) или Английский (EN).',
                    faqQ3: 'Сохраняются ли мои данные?',
                    faqA3: 'Нет, мы не храним персональные данные постоянно. Весь введенный контент используется исключительно для немедленной обработки и автоматически удаляется после завершения сессии. Сервис полностью соответствует GDPR.',
                    faqQ4: 'Бесплатен ли сервис?',
                    faqA4: 'Да, сервис полностью бесплатный. Вы можете генерировать столько мотивационных писем, сколько вам нужно, без оплаты или регистрации.',
                    faqQ5: 'Могу ли я редактировать сгенерированное письмо?',
                    faqA5: 'Да, после генерации вы можете редактировать письмо прямо в текстовом поле перед загрузкой в формате PDF. Таким образом, вы можете внести личные корректировки.'
                },
                en: {
                    appTitle: 'Cover Letter AI',
                    themeToggle: 'Dark Mode',
                    themeToggleLight: 'Light Mode',
                    serviceDescription: 'This service creates a tailored cover letter that is relevant to your resume and the job requirements.',
                    reviewPrompt: 'I would be grateful if you could leave a few lines with your impressions of this service',
                    submitReview: 'Submit Review',
                    biographyLabel: 'Biography - Write your resume in a free format: your skills, work experience, education:',
                    uploadPhotoButton: 'Upload photo for resume',
                    photoUploadProgress: 'Uploading photo...',
                    photoUploadSuccess: 'Photo uploaded successfully',
                    photoUploadError: 'Failed to upload photo',
                    photoUploadInvalidType: 'Only image files are allowed',
                    photoUploadTooLarge: 'Photo is too large (max 5 MB)',
                    jobPostingLabel: 'Job Posting - simply copy the job posting text here.:',
                    wishesLabel: 'Here you can add an additional prompt (instruction for AI) or information about you that was not included in the resume (optional):',
                    generateButton: 'Create Documents',
                    progressInitializing: 'Initializing...',
                    progressReadingBiography: 'Reading Biography',
                    progressAnalyzingBiography: 'Analyzing Biography',
                    progressReadingJobPosting: 'Reading Job Posting',
                    progressAnalyzingJobPosting: 'Analyzing Job Posting',
                    progressCreatingLetter: 'Creating Cover Letter',
                    progressGenerating: 'Generating Content...',
                    progressFinalizing: 'Finalizing Document',
                    progressComplete: 'Complete',
                    errorTitle: 'Error',
                    coverLetterTitle: 'Cover Letter (Anschreiben)',
                    downloadLebenslaufButton: 'Download Resume',
                    downloadAnschreibenButton: 'Download Cover Letter',
                    downloadLebenslaufButtonGenerating: 'Generating resume PDF...',
                    downloadAnschreibenButtonGenerating: 'Generating cover letter PDF...',
                    privacyTitle: 'Privacy',
                    privacyText: 'Technical provision is done via <a href="https://www.oracle.com/cloud/" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline">Oracle Cloud</a>, processing of certain content via the OpenAI API – each in accordance with GDPR requirements.',
                    errorBiographyEmpty: 'Biography cannot be empty',
                    errorJobPostingEmpty: 'Job posting cannot be empty',
                    errorInvalidResponse: 'Invalid response from server',
                    errorApiError: 'An error occurred',
                    errorPdfGeneration: 'PDF generation failed',
                    errorPdfError: 'Error generating PDF: ',
                    alertFillLetter: 'Please fill in the cover letter first.',
                    helpTitle: 'Help',
                    helpDescription: 'This service creates a tailored cover letter that is relevant to your resume and the job requirements.',
                    helpLanguageText: 'You can enter data in any language. The generated cover letter will be automatically created in the language you selected in the language selector menu at the top (DE, RU or EN).',
                    helpPrivacyText: 'We do not store personal data permanently. Entered content is used exclusively for immediate processing and is automatically deleted after the session ends. Technical provision is done via <a href="https://www.oracle.com/cloud/" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline">Oracle Cloud</a>, processing of certain content via the OpenAI API – each in accordance with GDPR requirements.',
                    sharePrompt: 'If you liked it, please share this service with colleagues!',
                    privacyLinkFooter: 'Privacy Policy',
                    impressumLink: 'Imprint',
                    whatsappShareTitle: 'Share on WhatsApp',
                    facebookShareTitle: 'Share on Facebook',
                    linkedinShareTitle: 'Share on LinkedIn',
                    telegramShareTitle: 'Share on Telegram',
                    instagramShareTitle: 'Share on Instagram',
                    instagramToastMessage: 'Link copied, paste it into a new post.',
                    shareTextFull: 'If you are actively looking for work and applying to a large number of job openings, you know how tedious it is to write a separate cover letter each time.\n\nTo simplify this process, I would like to recommend a service that helps significantly speed up the preparation of cover letters for different job openings. This saves time and reduces routine, especially when applying to multiple positions.\n\nService:\n{url}\n\nWill be useful for those who are actively looking for work and want to focus on content rather than endlessly rewriting the same text.',
                    shareTextShort: 'If you are actively looking for work and applying to a large number of job openings, you know how tedious it is to write a separate cover letter each time. To simplify this process, I would like to recommend a service that helps significantly speed up the preparation of cover letters for different job openings.',
                    faqLink: 'Frequently Asked Questions (FAQ)',
                    faqQ1: 'How does the Bewerbung AI service work?',
                    faqA1: 'Our service uses artificial intelligence (AI) to analyze your biography and the job posting. Based on this analysis, it generates a tailored cover letter that is customized to the specific requirements of the position and complies with German DIN 5008 standards.',
                    faqQ2: 'In which languages can I use the service?',
                    faqA2: 'You can enter your data in any language. The generated cover letter will be automatically created in the language you selected in the language selector menu - German (DE), Russian (RU), or English (EN).',
                    faqQ3: 'Is my data stored?',
                    faqA3: 'No, we do not store personal data permanently. All entered content is used exclusively for immediate processing and is automatically deleted after the session ends. The service is fully GDPR compliant.',
                    faqQ4: 'Is the service free?',
                    faqA4: 'Yes, the service is completely free. You can generate as many cover letters as you need without fees or registration.',
                    faqQ5: 'Can I edit the generated cover letter?',
                    faqA5: 'Yes, after generation, you can edit the cover letter directly in the text field before downloading it as a PDF. This allows you to make personal adjustments.'
                }
            };

            function safeGetStoredValue(key) {
                try {
                    return localStorage.getItem(key);
                } catch (error) {
                    return null;
                }
            }

            function safeStoreValue(key, value) {
                try {
                    localStorage.setItem(key, value);
                } catch (error) {
                    // Storage can be blocked on some mobile browsers; ignore silently.
                }
            }

            function getCurrentLanguage() {
                // Проверяем сохраненный язык в localStorage (приоритет - выбор пользователя)
                const stored = safeGetStoredValue(LANGUAGE_STORAGE_KEY);
                if (stored && (stored === 'de' || stored === 'ru' || stored === 'en')) {
                    return stored;
                }
                
                // Если нет сохраненного, определяем по языку браузера
                const browserLangs = navigator.languages || [navigator.language || navigator.userLanguage];
                
                for (const lang of browserLangs) {
                    const langCode = lang.split('-')[0].toLowerCase(); // "de-DE" -> "de", "ru-RU" -> "ru"
                    if (langCode === 'de' || langCode === 'ru' || langCode === 'en') {
                        return langCode;
                    }
                }
                
                // Если язык браузера не поддерживается, возвращаем дефолтный
                return 'de';
            }

            function translate(key, lang) {
                const langData = translations[lang] || translations.de;
                return langData[key] || key;
            }

            function applyTranslations(lang) {
                const elements = document.querySelectorAll('[data-i18n]');
                // Keys that contain HTML and should use innerHTML
                const htmlKeys = ['privacyText', 'helpPrivacyText'];
                
                elements.forEach(element => {
                    const key = element.getAttribute('data-i18n');
                    const text = translate(key, lang);
                    if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                        element.placeholder = text;
                    } else if (htmlKeys.includes(key)) {
                        element.innerHTML = text;
                    } else {
                        element.textContent = text;
                    }
                });
                
                // Update title attributes for share buttons
                const titleElements = document.querySelectorAll('[data-i18n-title]');
                titleElements.forEach(element => {
                    const key = element.getAttribute('data-i18n-title');
                    const text = translate(key, lang);
                    element.title = text;
                });

                // Update theme toggle text based on current theme
                const themeToggle = document.getElementById('themeToggle');
                if (themeToggle) {
                    const isDark = document.documentElement.classList.contains('dark');
                    themeToggle.textContent = isDark 
                        ? translate('themeToggleLight', lang) 
                        : translate('themeToggle', lang);
                }
            }

            // Initialize language selector
            const languageSelector = document.getElementById('languageSelector');
            if (languageSelector) {
                const currentLang = getCurrentLanguage();
                languageSelector.value = currentLang;
                applyTranslations(currentLang);
                
                // Load sample data for current language
                if (window.loadSampleData) {
                    window.loadSampleData(currentLang);
                }

                languageSelector.addEventListener('change', (e) => {
                    const newLang = e.target.value;
                    safeStoreValue(LANGUAGE_STORAGE_KEY, newLang);
                    applyTranslations(newLang);
                    // Update share links when language changes
                    if (typeof updateShareLinksMain === 'function') {
                        updateShareLinksMain();
                    }
                    // Reload sample data when language changes
                    if (window.loadSampleData) {
                        window.loadSampleData(newLang);
                    }
                });
            }

            // Export translation function for use in other scripts
            window.i18n = {
                translate: (key) => translate(key, getCurrentLanguage()),
                getCurrentLanguage: getCurrentLanguage
            };
        })();

        // Progress Bar Management
        class ProgressBar {
            constructor() {
                this.segments = 24; // Number of segments in the ring
                this.currentProgress = 0;
                this.messages = [
                    { key: "progressReadingBiography", progress: 5 },
                    { key: "progressAnalyzingBiography", progress: 15 },
                    { key: "progressReadingJobPosting", progress: 25 },
                    { key: "progressAnalyzingJobPosting", progress: 40 },
                    { key: "progressCreatingLetter", progress: 50 },
                    { key: "progressGenerating", progress: 70 },
                    { key: "progressFinalizing", progress: 95 }
                ];
                this.currentMessageIndex = 0;
                this.init();
            }

            init() {
                const svg = document.querySelector('.progress-ring svg');
                const radius = 45;
                const circumference = 2 * Math.PI * radius;
                const segmentAngle = 360 / this.segments;
                const gapAngle = 2; // Gap between segments in degrees
                const arcAngle = segmentAngle - gapAngle;

                // Create segments as dashed arcs
                for (let i = 0; i < this.segments; i++) {
                    const startAngle = (i * segmentAngle - 90) * (Math.PI / 180);
                    const endAngle = (i * segmentAngle + arcAngle - 90) * (Math.PI / 180);
                    
                    // Calculate arc endpoints
                    const startX = 50 + radius * Math.cos(startAngle);
                    const startY = 50 + radius * Math.sin(startAngle);
                    const endX = 50 + radius * Math.cos(endAngle);
                    const endY = 50 + radius * Math.sin(endAngle);
                    
                    // Determine if arc is large (more than 180 degrees)
                    const largeArc = arcAngle > 180 ? 1 : 0;
                    
                    // Create path for arc segment
                    const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                    path.setAttribute('d', `M ${startX} ${startY} A ${radius} ${radius} 0 ${largeArc} 1 ${endX} ${endY}`);
                    path.setAttribute('class', 'progress-segment inactive');
                    path.setAttribute('data-index', i);
                    
                    // Make it dashed
                    const arcLength = (arcAngle / 360) * circumference;
                    const dashLength = arcLength * 0.6; // 60% dash
                    const dashGap = arcLength * 0.4; // 40% gap
                    path.setAttribute('stroke-dasharray', `${dashLength} ${dashGap}`);
                    
                    svg.appendChild(path);
                }
            }

            update(progress) {
                this.currentProgress = Math.min(100, Math.max(0, progress));
                const activeSegments = Math.floor((this.currentProgress / 100) * this.segments);
                const isComplete = this.currentProgress >= 100;
                
                // Update segments
                const segments = document.querySelectorAll('.progress-segment');
                segments.forEach((segment, index) => {
                    if (index < activeSegments) {
                        segment.classList.remove('inactive');
                        segment.classList.add('active');
                        // Add blinking animation if not complete
                        if (!isComplete) {
                            segment.classList.add('blinking');
                        } else {
                            segment.classList.remove('blinking');
                        }
                    } else {
                        segment.classList.remove('active');
                        segment.classList.remove('blinking');
                        segment.classList.add('inactive');
                    }
                });
                
                // Update percentage
                document.getElementById('progressPercent').textContent = Math.round(this.currentProgress) + '%';
                
                // Update message - find the last message where progress is >= current progress
                // Initialize with first message as fallback for progress < first threshold
                let message = this.messages[0];
                for (let i = this.messages.length - 1; i >= 0; i--) {
                    if (this.currentProgress >= this.messages[i].progress) {
                        message = this.messages[i];
                        break;
                    }
                }
                if (message) {
                    const label = document.getElementById('progressLabel');
                    label.textContent = window.i18n ? window.i18n.translate(message.key) : message.key;
                    label.classList.add('active');
                }
            }

            start() {
                this.currentProgress = 0;
                this.currentMessageIndex = 0;
                this.update(0);
            }

            complete() {
                this.update(100);
                // Remove blinking from all segments when complete
                const segments = document.querySelectorAll('.progress-segment');
                segments.forEach(segment => {
                    segment.classList.remove('blinking');
                });
                const label = document.getElementById('progressLabel');
                label.textContent = window.i18n ? window.i18n.translate('progressComplete') : 'Abgeschlossen';
                label.classList.add('active');
            }
        }

        // Initialize progress bar
        const progressBar = new ProgressBar();

        // Store loaded sample data for comparison
        let loadedSampleData = {
            biography: null,
            jobPosting: null,
            wishes: null,
            language: null
        };
        let uploadedPhotoId = null;

        // Normalize text for comparison (remove all whitespace)
        function normalizeText(text) {
            if (!text) return '';
            return text.replace(/\s+/g, '');
        }

        // Check if there are significant changes (ignoring whitespace)
        function hasSignificantChanges() {
            const biographyText = document.getElementById('biographyTextarea').value || '';
            const jobPostingText = document.getElementById('jobPostingTextarea').value || '';
            const wishesText = document.getElementById('wishesTextarea').value || '';
            
            const currentLang = window.i18n ? window.i18n.getCurrentLanguage() : 'de';
            
            if (uploadedPhotoId) {
                return true;
            }

            // If language changed or samples not loaded, consider it as changed
            if (loadedSampleData.language !== currentLang || 
                !loadedSampleData.biography || 
                !loadedSampleData.jobPosting) {
                return true;
            }
            
            // Compare normalized texts (ignoring whitespace)
            const biographyChanged = normalizeText(biographyText) !== normalizeText(loadedSampleData.biography);
            const jobPostingChanged = normalizeText(jobPostingText) !== normalizeText(loadedSampleData.jobPosting);
            const wishesChanged = normalizeText(wishesText) !== normalizeText(loadedSampleData.wishes || '');
            
            return biographyChanged || jobPostingChanged || wishesChanged;
        }

        // Load sample data from separate files based on language
        function shouldReplaceWithSample(currentValue, previousSampleValue) {
            const normalizedCurrent = normalizeText(currentValue || '');
            if (!normalizedCurrent) {
                return true;
            }
            if (!previousSampleValue) {
                return false;
            }
            return normalizedCurrent === normalizeText(previousSampleValue);
        }

        async function loadSampleData(lang) {
            try {
                const biographyTextarea = document.getElementById('biographyTextarea');
                const jobPostingTextarea = document.getElementById('jobPostingTextarea');
                const wishesTextarea = document.getElementById('wishesTextarea');

                const currentBiographyValue = biographyTextarea ? biographyTextarea.value : '';
                const currentJobPostingValue = jobPostingTextarea ? jobPostingTextarea.value : '';
                const currentWishesValue = wishesTextarea ? wishesTextarea.value : '';

                const previousSampleData = {
                    biography: loadedSampleData.biography,
                    jobPosting: loadedSampleData.jobPosting,
                    wishes: loadedSampleData.wishes
                };

                // Determine file suffix based on language (default to empty for German)
                let suffix = '';
                if (lang === 'en') {
                    suffix = '_en';
                } else if (lang === 'ru') {
                    suffix = '_ru';
                }
                // For German (de), use default files without suffix
                
                // Fetch sample biography
                let sampleBiography = null;
                const biographyResponse = await fetch(`/sample_biography${suffix}.txt`);
                if (!biographyResponse.ok) {
                    // Fallback to default if language-specific file doesn't exist
                    const fallbackResponse = await fetch('/sample_biography.txt');
                    sampleBiography = await fallbackResponse.text();
                } else {
                    sampleBiography = await biographyResponse.text();
                }
                const biographySampleTrimmed = sampleBiography.trim();
                if (biographyTextarea && shouldReplaceWithSample(currentBiographyValue, previousSampleData.biography)) {
                    biographyTextarea.value = biographySampleTrimmed;
                }
                loadedSampleData.biography = biographySampleTrimmed;
                
                // Fetch sample job posting
                let sampleJobPosting = null;
                const jobPostingResponse = await fetch(`/sample_job_posting${suffix}.txt`);
                if (!jobPostingResponse.ok) {
                    // Fallback to default if language-specific file doesn't exist
                    const fallbackResponse = await fetch('/sample_job_posting.txt');
                    sampleJobPosting = await fallbackResponse.text();
                } else {
                    sampleJobPosting = await jobPostingResponse.text();
                }
                const jobPostingSampleTrimmed = sampleJobPosting.trim();
                if (jobPostingTextarea && shouldReplaceWithSample(currentJobPostingValue, previousSampleData.jobPosting)) {
                    jobPostingTextarea.value = jobPostingSampleTrimmed;
                }
                loadedSampleData.jobPosting = jobPostingSampleTrimmed;
                
                // Fetch sample wishes
                try {
                    const wishesResponse = await fetch(`/sample_wishes${suffix}.txt`);
                    if (!wishesResponse.ok) {
                        // Fallback to default if language-specific file doesn't exist
                        const fallbackResponse = await fetch('/sample_wishes.txt');
                        if (fallbackResponse.ok) {
                            const sampleWishes = await fallbackResponse.text();
                            const wishesSampleTrimmed = sampleWishes.trim();
                            if (wishesTextarea && shouldReplaceWithSample(currentWishesValue, previousSampleData.wishes || '')) {
                                wishesTextarea.value = wishesSampleTrimmed;
                            }
                            loadedSampleData.wishes = wishesSampleTrimmed;
                        } else {
                            loadedSampleData.wishes = '';
                        }
                    } else {
                        const sampleWishes = await wishesResponse.text();
                        const wishesSampleTrimmed = sampleWishes.trim();
                        if (wishesTextarea && shouldReplaceWithSample(currentWishesValue, previousSampleData.wishes || '')) {
                            wishesTextarea.value = wishesSampleTrimmed;
                        }
                        loadedSampleData.wishes = wishesSampleTrimmed;
                    }
                } catch (wishesError) {
                    console.warn('Error loading sample wishes (optional field):', wishesError);
                    loadedSampleData.wishes = '';
                }
                
                // Store current language
                loadedSampleData.language = lang;
            } catch (error) {
                console.error('Error loading sample data:', error);
                // If files fail to load, leave textareas empty
            }
        }

        // Export loadSampleData to window for use in language system
        window.loadSampleData = loadSampleData;

        const photoInput = document.getElementById('photoInput');
        const uploadPhotoButton = document.getElementById('uploadPhotoButton');
        const photoUploadStatus = document.getElementById('photoUploadStatus');

        async function uploadResumePhoto(file) {
            if (!file) {
                return;
            }

            if (!file.type || !file.type.startsWith('image/')) {
                throw new Error(window.i18n ? window.i18n.translate('photoUploadInvalidType') : 'Only image files are allowed');
            }

            const maxFileSize = 5 * 1024 * 1024;
            if (file.size > maxFileSize) {
                throw new Error(window.i18n ? window.i18n.translate('photoUploadTooLarge') : 'Photo is too large (max 5 MB)');
            }

            if (photoUploadStatus) {
                photoUploadStatus.textContent = window.i18n ? window.i18n.translate('photoUploadProgress') : 'Uploading photo...';
                photoUploadStatus.className = 'text-sm text-slate-600 dark:text-slate-300';
            }

            const formData = new FormData();
            formData.append('photo', file);

            const response = await fetch('/api/generate/upload-photo', {
                method: 'POST',
                body: formData
            });

            let responseData = {};
            try {
                responseData = await response.json();
            } catch (e) {
                responseData = {};
            }

            if (!response.ok) {
                const message = responseData.message || responseData.error || (window.i18n ? window.i18n.translate('photoUploadError') : 'Failed to upload photo');
                throw new Error(message);
            }

            uploadedPhotoId = responseData.photoId || String(Date.now());

            if (photoUploadStatus) {
                photoUploadStatus.textContent = window.i18n ? window.i18n.translate('photoUploadSuccess') : 'Photo uploaded successfully';
                photoUploadStatus.className = 'text-sm text-emerald-600 dark:text-emerald-400';
            }
        }

        if (uploadPhotoButton && photoInput) {
            uploadPhotoButton.addEventListener('click', function() {
                photoInput.click();
            });

            photoInput.addEventListener('change', async function() {
                const selectedFile = photoInput.files && photoInput.files.length > 0 ? photoInput.files[0] : null;
                if (!selectedFile) {
                    return;
                }

                uploadPhotoButton.disabled = true;
                try {
                    await uploadResumePhoto(selectedFile);
                } catch (error) {
                    if (photoUploadStatus) {
                        photoUploadStatus.textContent = error.message || (window.i18n ? window.i18n.translate('photoUploadError') : 'Failed to upload photo');
                        photoUploadStatus.className = 'text-sm text-red-600 dark:text-red-400';
                    }
                } finally {
                    uploadPhotoButton.disabled = false;
                    photoInput.value = '';
                }
            });
        }
        
        // Load sample data when page loads (after language system is initialized)
        // Wait a bit to ensure language system is ready
        setTimeout(() => {
            const currentLang = window.i18n ? window.i18n.getCurrentLanguage() : 'de';
            loadSampleData(currentLang);
        }, 100);

        // Form submission handler
        document.getElementById('generateForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const biographyTextarea = document.getElementById('biographyTextarea');
            const jobPostingTextarea = document.getElementById('jobPostingTextarea');
            const wishesTextarea = document.getElementById('wishesTextarea');
            const generateButton = document.getElementById('generateButton');
            const loading = document.getElementById('loading');
            const results = document.getElementById('results');
            const errorSection = document.getElementById('errorSection');
            const errorContent = document.getElementById('errorContent');
            
            // Hide previous results
            results.classList.add('hidden');
            errorSection.classList.add('hidden');
            
            // Show loading state
            loading.classList.remove('hidden');
            generateButton.disabled = true;
            
            // Start progress bar
            progressBar.start();
            
            let progressInterval = null;
            let generationProgressInterval = null;
            
            try {
                // Validate biography text
                const biographyText = biographyTextarea.value.trim();
                if (!biographyText || biographyText.length === 0) {
                    throw new Error(window.i18n ? window.i18n.translate('errorBiographyEmpty') : 'Biography cannot be empty');
                }
                
                // Validate job posting
                const jobPostingText = jobPostingTextarea.value.trim();
                if (!jobPostingText || jobPostingText.length === 0) {
                    throw new Error(window.i18n ? window.i18n.translate('errorJobPostingEmpty') : 'Job posting cannot be empty');
                }
                
                // Check if there are significant changes
                const hasChanges = hasSignificantChanges();
                
                if (!hasChanges) {
                    // No significant changes - load sample cover letter from file instead of calling API
                    console.log('No significant changes detected, loading sample cover letter from file');
                    
                    // Update progress: Loading sample document
                    progressBar.update(10);
                    await new Promise(resolve => setTimeout(resolve, 300));
                    
                    // Determine file suffix based on language
                    const currentLanguage = window.i18n ? window.i18n.getCurrentLanguage() : 'de';
                    let suffix = '';
                    if (currentLanguage === 'en') {
                        suffix = '_en';
                    } else if (currentLanguage === 'ru') {
                        suffix = '_ru';
                    }
                    
                    // Load sample cover letter
                    progressBar.update(50);
                    await new Promise(resolve => setTimeout(resolve, 400));
                    
                    try {
                        const coverLetterResponse = await fetch(`/sample_coverLetter${suffix}.txt`);
                        let sampleCoverLetter;
                        if (!coverLetterResponse.ok) {
                            // Fallback to default if language-specific file doesn't exist
                            const fallbackResponse = await fetch('/sample_coverLetter.txt');
                            sampleCoverLetter = await fallbackResponse.text();
                        } else {
                            sampleCoverLetter = await coverLetterResponse.text();
                        }
                        
                        progressBar.update(95);
                        await new Promise(resolve => setTimeout(resolve, 300));
                        
                        progressBar.complete();
                        await new Promise(resolve => setTimeout(resolve, 500));
                        
                        // Display results
                        document.getElementById('coverLetterTextarea').value = sampleCoverLetter.trim();
                        results.classList.remove('hidden');
                        return; // Exit early, no API call needed
                    } catch (coverLetterError) {
                        console.warn('Error loading sample cover letter, falling back to API:', coverLetterError);
                        // Fall through to API call if file loading fails
                    }
                }
                
                // Significant changes detected or sample file failed - proceed with API call
                // Update progress: Reading biography
                progressBar.update(5);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // Update progress: Analyzing biography
                progressBar.update(15);
                await new Promise(resolve => setTimeout(resolve, 400));
                
                // Create a Blob from the biography text and convert it to a File
                const biographyBlob = new Blob([biographyText], { type: 'text/plain' });
                const biographyFile = new File([biographyBlob], 'biography.txt', { type: 'text/plain' });
                
                // Update progress: Reading job posting
                progressBar.update(25);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // Update progress: Analyzing job posting
                progressBar.update(40);
                await new Promise(resolve => setTimeout(resolve, 400));
                
                // Prepare form data
                const formData = new FormData();
                formData.append('biographyFile', biographyFile);
                formData.append('jobPosting', jobPostingText);
                const wishesText = wishesTextarea.value.trim();
                if (wishesText) {
                    formData.append('wishes', wishesText);
                }
                // Add language parameter
                const currentLanguage = window.i18n ? window.i18n.getCurrentLanguage() : 'de';
                formData.append('language', currentLanguage);
                console.log('Sending language parameter:', currentLanguage);
                
                // Update progress: Starting generation
                progressBar.update(50);
                
                // Start simulating progress during generation (50% to 95%)
                let generationProgress = 50;
                generationProgressInterval = setInterval(() => {
                    if (generationProgress < 95) {
                        // Slow down as we approach 95%
                        const remaining = 95 - generationProgress;
                        const increment = remaining > 10 ? 0.8 : (remaining > 5 ? 0.4 : 0.2);
                        generationProgress = Math.min(95, generationProgress + increment);
                        progressBar.update(generationProgress);
                    }
                }, 400); // Update every 400ms
                
                // Send POST request
                const response = await fetch('/api/generate/from-file', {
                    method: 'POST',
                    body: formData
                });
                
                // Stop generation progress simulation
                if (generationProgressInterval) {
                    clearInterval(generationProgressInterval);
                    generationProgressInterval = null;
                }
                
                // Update progress: Finalizing
                progressBar.update(95);
                
                // Parse response
                let responseData;
                try {
                    responseData = await response.json();
                } catch (jsonError) {
                    throw new Error(window.i18n ? window.i18n.translate('errorInvalidResponse') : 'Invalid response from server');
                }
                
                if (!response.ok) {
                    // Handle API error response
                    const errorMessage = responseData.message || responseData.error || (window.i18n ? window.i18n.translate('errorApiError') : 'An error occurred');
                    throw new Error(`API Error (${response.status}): ${errorMessage}`);
                }
                
                // Complete progress
                if (generationProgressInterval) {
                    clearInterval(generationProgressInterval);
                }
                if (progressInterval) {
                    clearInterval(progressInterval);
                }
                progressBar.complete();
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Display results
                document.getElementById('coverLetterTextarea').value = responseData.coverLetter || 'No cover letter generated';
                results.classList.remove('hidden');
                
            } catch (error) {
                // Stop progress simulation on error
                if (generationProgressInterval) {
                    clearInterval(generationProgressInterval);
                }
                if (progressInterval) {
                    clearInterval(progressInterval);
                }
                
                // Display error
                errorContent.textContent = error.message || 'An unexpected error occurred';
                errorSection.classList.remove('hidden');
                console.error('Error:', error);
            } finally {
                // Hide loading state
                loading.classList.add('hidden');
                generateButton.disabled = false;
            }
        });

        // Download cover letter PDF button handler
        document.getElementById('downloadAnschreibenButton').addEventListener('click', async function() {
            const coverLetterText = document.getElementById('coverLetterTextarea').value;
            const downloadAnschreibenButton = document.getElementById('downloadAnschreibenButton');
            
            if (!coverLetterText || coverLetterText.trim().length === 0) {
                alert(window.i18n ? window.i18n.translate('alertFillLetter') : 'Bitte füllen Sie zuerst das Anschreiben aus.');
                return;
            }
            
            downloadAnschreibenButton.disabled = true;
            downloadAnschreibenButton.textContent = window.i18n ? window.i18n.translate('downloadAnschreibenButtonGenerating') : 'Anschreiben-PDF wird generiert...';
            
            try {
                const response = await fetch('/api/generate/pdf', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ coverLetter: coverLetterText })
                });
                
                if (!response.ok) {
                    throw new Error(window.i18n ? window.i18n.translate('errorPdfGeneration') : 'PDF-Generierung fehlgeschlagen');
                }
                
                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'Anschreiben.pdf';
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
            } catch (error) {
                console.error('Error downloading PDF:', error);
                const errorMsg = window.i18n ? window.i18n.translate('errorPdfError') : 'Fehler beim Generieren des PDFs: ';
                alert(errorMsg + error.message);
            } finally {
                downloadAnschreibenButton.disabled = false;
                downloadAnschreibenButton.textContent = window.i18n ? window.i18n.translate('downloadAnschreibenButton') : 'Herunterladen Bewerbungsanschreiben';
            }
        });

        // Download resume PDF button handler
        document.getElementById('downloadLebenslaufButton').addEventListener('click', async function() {
            const downloadLebenslaufButton = document.getElementById('downloadLebenslaufButton');
            downloadLebenslaufButton.disabled = true;
            downloadLebenslaufButton.textContent = window.i18n ? window.i18n.translate('downloadLebenslaufButtonGenerating') : 'Lebenslauf-PDF wird generiert...';

            try {
                const useDefaultPdf = !hasSignificantChanges();
                const response = await fetch(`/api/generate/pdf/lebenslauf?defaultData=${useDefaultPdf}`, {
                    method: 'GET'
                });

                if (!response.ok) {
                    throw new Error(window.i18n ? window.i18n.translate('errorPdfGeneration') : 'PDF-Generierung fehlgeschlagen');
                }

                const blob = await response.blob();
                const contentDisposition = response.headers.get('content-disposition');
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = extractFilenameFromDisposition(contentDisposition) || 'Lebenslauf.pdf';
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
            } catch (error) {
                console.error('Error downloading resume PDF:', error);
                const errorMsg = window.i18n ? window.i18n.translate('errorPdfError') : 'Fehler beim Generieren des PDFs: ';
                alert(errorMsg + error.message);
            } finally {
                downloadLebenslaufButton.disabled = false;
                downloadLebenslaufButton.textContent = window.i18n ? window.i18n.translate('downloadLebenslaufButton') : 'Herunterladen Lebenslauf';
            }
        });

        function extractFilenameFromDisposition(contentDisposition) {
            if (!contentDisposition || typeof contentDisposition !== 'string') {
                return null;
            }

            // RFC 5987: filename*=UTF-8''encoded-name.pdf
            const utf8FilenameMatch = contentDisposition.match(/filename\*=UTF-8''([^;]+)/i);
            if (utf8FilenameMatch && utf8FilenameMatch[1]) {
                try {
                    return decodeURIComponent(utf8FilenameMatch[1].trim());
                } catch (e) {
                    return utf8FilenameMatch[1].trim();
                }
            }

            // Fallback: filename="name.pdf" or filename=name.pdf
            const basicFilenameMatch = contentDisposition.match(/filename="?([^";]+)"?/i);
            if (basicFilenameMatch && basicFilenameMatch[1]) {
                return basicFilenameMatch[1].trim();
            }

            return null;
        }

        // Setup share links
        (function initShareLinks() {
            const whatsappShare = document.getElementById('whatsappShareMain');
            const facebookShare = document.getElementById('facebookShareMain');
            const linkedinShare = document.getElementById('linkedinShareMain');
            const telegramShare = document.getElementById('telegramShareMain');
            const instagramShare = document.getElementById('instagramShareMain');

            if (!whatsappShare || !facebookShare || !linkedinShare || !telegramShare || !instagramShare) {
                return;
            }

            // Setup Instagram share handler (only once)
            if (instagramShare) {
                instagramShare.addEventListener('click', function(e) {
                    e.preventDefault();
                    const shortUrl = 'https://bit.ly/4t7TusE';
                    
                    // Function to show toast notification
                    function showToast(message) {
                        const toast = document.getElementById('toastNotification');
                        if (toast) {
                            const toastText = toast.querySelector('p');
                            if (toastText) {
                                toastText.textContent = message;
                            }
                            toast.classList.add('show');
                            
                            // Hide toast after 4 seconds
                            setTimeout(() => {
                                toast.classList.remove('show');
                            }, 4000);
                        }
                    }
                    
                    // Try to copy URL to clipboard
                    if (navigator.clipboard && navigator.clipboard.writeText) {
                        navigator.clipboard.writeText(shortUrl).then(() => {
                            // Show toast notification
                            const message = window.i18n ? window.i18n.translate('instagramToastMessage') : 'Ссылка скопирована, вставь её в новый пост.';
                            showToast(message);
                            // Open Instagram after 3 seconds delay
                            setTimeout(() => {
                                window.open('https://www.instagram.com/', '_blank');
                            }, 3000);
                        }).catch(() => {
                            // Fallback: show message even if clipboard fails
                            const message = window.i18n ? window.i18n.translate('instagramToastMessage') : 'Ссылка скопирована, вставь её в новый пост.';
                            showToast(message);
                            // Open Instagram after 3 seconds delay
                            setTimeout(() => {
                                window.open('https://www.instagram.com/', '_blank');
                            }, 3000);
                        });
                    } else {
                        // Fallback: show message if clipboard API is not available
                        const message = window.i18n ? window.i18n.translate('instagramToastMessage') : 'Instagram не позволяет автоматически создавать посты. Ссылка скопирована — вставь её в новый пост.';
                        showToast(message);
                        // Open Instagram after 3 seconds delay
                        setTimeout(() => {
                            window.open('https://www.instagram.com/', '_blank');
                        }, 3000);
                    }
                });
            }

            // Function to update share links based on current language
            function updateShareLinksMain() {
                const currentLang = window.i18n ? window.i18n.getCurrentLanguage() : 'ru';
                const currentUrl = 'http://130.162.224.203:8080/';
                
                const shareTextFullTemplate = window.i18n ? window.i18n.translate('shareTextFull') : 'Если вы активно ищете работу и откликаетесь на большое количество вакансий, вы знаете, насколько утомительно каждый раз писать отдельное мотивационное письмо.\n\nЧтобы упростить этот процесс, я хочу порекомендовать сервис, который помогает значительно ускорить подготовку мотивационных писем под разные вакансии. Это экономит время и снижает рутину, особенно при массовых откликах.\n\nСервис:\n{url}\n\nБудет полезен тем, кто находится в активном поиске работы и хочет сосредоточиться на содержании, а не на бесконечном переписывании одного и того же текста.';
                const shareTextFull = shareTextFullTemplate.replace('{url}', currentUrl);
                const shareText = encodeURIComponent(shareTextFull);
                
                const shareTextShort = encodeURIComponent(window.i18n ? window.i18n.translate('shareTextShort') : 'Если вы активно ищете работу и откликаетесь на большое количество вакансий, вы знаете, насколько утомительно каждый раз писать отдельное мотивационное письмо. Чтобы упростить этот процесс, я хочу порекомендовать сервис, который помогает значительно ускорить подготовку мотивационных писем под разные вакансии.');

                // Setup share links
                if (whatsappShare) whatsappShare.href = `https://wa.me/?text=${shareText}`;
                if (facebookShare) facebookShare.href = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(currentUrl)}&quote=${shareTextShort}`;
                if (linkedinShare) linkedinShare.href = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(currentUrl)}`;
                if (telegramShare) telegramShare.href = `https://t.me/share/url?url=${encodeURIComponent(currentUrl)}&text=${shareTextShort}`;
                // Instagram handler is set up separately above
            }

            // Initial setup
            updateShareLinksMain();
            
            // Make function available globally for language change updates
            window.updateShareLinksMain = updateShareLinksMain;
        })();
    </script>

    <!-- Toast notification -->
    <div id="toastNotification" role="alert">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <p></p>
    </div>

    <!-- Scroll to top button -->
    <button id="scrollToTop" type="button" aria-label="Scroll to top" title="Nach oben">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
        </svg>
    </button>

    <script>
        // Scroll to top button - must be after the button element in DOM
        (function initScrollToTop() {
            const scrollToTopButton = document.getElementById('scrollToTop');
            
            if (!scrollToTopButton) {
                console.error('Scroll to top button not found');
                return;
            }

            // Show/hide button based on scroll position
            function toggleScrollButton() {
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
                if (scrollTop > 100) {
                    scrollToTopButton.style.display = 'flex';
                } else {
                    scrollToTopButton.style.display = 'none';
                }
            }

            // Scroll to top function
            function scrollToTop() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            }

            // Event listeners
            window.addEventListener('scroll', toggleScrollButton, { passive: true });
            window.addEventListener('resize', toggleScrollButton);
            scrollToTopButton.addEventListener('click', scrollToTop);

            // Initial check
            toggleScrollButton();
        })();
    </script>
</body>
</html>

